## 问题二：大规模竞赛中评审排序方法分析与标准分模型优化

### 1. 问题理解与挑战

“标准分”法（见附件1）假定每位专家所评作品的学术水平分布一致，从而通过标准化消除专家间打分尺度差异。但在大规模人工智能创新应用类竞赛中，这一假设难以成立：  
- 每位专家评审作品仅为全部作品的极小部分，且不同专家评分交集有限。  
- 专家所评作品学术水平分布可能差异明显，导致标准分失真。

因此，需分析并比较多种评审排序方法，并用数据（附件2数据1）和权威结果进行模型优化与验证。

---

### 2. 现有方案与自定义替代方案

#### 2.1 标准分法（Z-score，附件1）

对每位专家的打分集合\(\{x_1, x_2, ..., x_n\}\)：
\[
z_i = 50 + 10 \times \frac{x_i - \mu}{\sigma}
\]
其中\(\mu\)为均值，\(\sigma\)为标准差。

#### 2.2 去极值法

每份作品评分，去除最高和最低分，剩余分数求均值。

#### 2.3 分位数归一法（自定义）

将专家打分转为百分位分数，再归一化处理，适应打分分布非正态的情况。

#### 2.4 “重叠校准”模型（自定义改进）

针对有重叠作品的专家，对有交集的作品分数做线性归一化，减弱分布差异影响，并用交集作品做专家间校准。

---

### 3. 数据分析流程与代码（以数据1为例）

#### 3.1 数据读取与预处理

```python
import pandas as pd
import numpy as np

df = pd.read_excel('数据1.xlsx')  # 假定每行为一作品，列有专家1~5打分，另有“协商排序”等字段
expert_cols = [col for col in df.columns if '专家' in col]
```

#### 3.2 标准分法

```python
def calc_standard_score(scores):
    mean = np.mean(scores)
    std = np.std(scores, ddof=0)
    if std == 0:
        return [50 for _ in scores]
    return [50 + 10 * (x - mean) / std for x in scores]

for col in expert_cols:
    df[col+'_std'] = calc_standard_score(df[col])
df['标准分均值'] = df[[c+'_std' for c in expert_cols]].mean(axis=1)
```

#### 3.3 去极值法

```python
def remove_min_max_and_mean(lst):
    return np.mean(sorted(lst)[1:-1])
df['去极值均值'] = df[[c+'_std' for c in expert_cols]].apply(lambda x: remove_min_max_and_mean(x), axis=1)
```

#### 3.4 分布特征可视化

```python
import matplotlib.pyplot as plt
plt.hist(df['标准分均值'], bins=20, alpha=0.5, label='标准分均值')
plt.hist(df['去极值均值'], bins=20, alpha=0.5, label='去极值均值')
plt.legend(); plt.title('作品归一得分分布'); plt.show()
```

#### 3.5 与权威协商排序相关性分析

假定“协商排序”列为权威排序，数值越小排名越靠前。

```python
from scipy.stats import spearmanr
result = df[['标准分均值', '去极值均值', '协商排序']].dropna()
corr1, _ = spearmanr(result['标准分均值'], result['协商排序'])
corr2, _ = spearmanr(result['去极值均值'], result['协商排序'])
print(f'标准分法与权威排序Spearman相关: {corr1:.3f}')
print(f'去极值法与权威排序Spearman相关: {corr2:.3f}')
```

#### 3.6 分位数归一法（可选）

```python
df['分位归一'] = df[[c+'_std' for c in expert_cols]].rank(pct=True, axis=0).mean(axis=1)
```

---

### 4. 方案对比与优缺点分析

| 方法         | 优点                                               | 缺点                                                       |
|--------------|----------------------------------------------------|------------------------------------------------------------|
| 标准分法     | 能消除专家尺度偏差，结构简单，便于实施             | 依赖专家间作品分布一致，实际大赛下不成立，可能失真         |
| 去极值法     | 抑制极端评分影响，提升鲁棒性                       | 若专家数少（如仅3-5人），去极值后信息损失较大               |
| 分位归一法   | 不依赖正态假设，适应分布偏态                       | 计算复杂，排名敏感性较高                                   |
| 重叠校准法   | 用交集作品校准专家分布，更科学                     | 需有足够交集作品，实际操作复杂                             |

**结论**：  
- 标准分法在大规模、交集稀疏时理论基础不再可靠，分布失真风险高。
- 去极值法适合专家数多时抑制异常，但信息损失需权衡。
- 分位归一和重叠校准法可作为补充，提升排名公平性。

---

### 5. 标准分计算模型优化建议

- **专家重叠校准模型**：针对有交集作品的专家，利用交集作品均值做线性变换，将专家打分归一到整体分布，提高分数可比性。
- **多方案结合**：实际操作时可多方案并行，取排序结果加权或综合，提升鲁棒性。

---

### 6. 权威数据验证与模型调优

- 用协商一致的“权威排序”数据，计算各方案与权威排序的Spearman相关系数，选择最优方案。
- 结合专家交集作品得分分布，反向推断和校正标准分模型参数，提升准确性。

---

### 7. 总结

针对大规模创新竞赛评分的分布异质性和交集稀疏，标准分法需结合实际情况优化或替换。多方案并行、重叠校准、分位归一等方法均可提升排序公正性，并需借助权威结果持续调整和验证模型，保障评审结果的科学性与实用性。